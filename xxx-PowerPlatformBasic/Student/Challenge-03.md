# Challenge 03 - Extract Order Data to Dataverse using Power Automate

[< Previous Challenge](./Challenge-02.md) - **[Home](../README.md)** - [Next Challenge >](./Challenge-04.md)

## Pre-requisites

Before you can build the Power Automate flow, you need:
- Finish challenge 1-2
- An account with access to Power Automate
- An Office365 Mailbox to accept incoming Order information

## Challenge

Current process: All orders from  larger contracts come through a single shared mailbox (Will need to setup the mailbox and provide the email address for the hack). Order would be send as an attachment using the Ordering Product Template. (1)

In this challenge learners will discuss the value of automation, synergizing automation with people, and implementing power automate and AI Builder.

Power Automate is a service that helps you create automated workflows between your favorite apps and services to synchronize files, get notifications, collect data, and more. Now that you have installed the right license to unlock access to PowerApps and Power Automate. AI builder is trained and tested from challenge 2. Next we want to start using Power Automate integrated with your AI builder to do form processing and store the data into Dataverse tables. 

## Description

In this challenge, you will build a cloud flow to extract data from the forms and save them into Dataverse.  
The good practice is to create a new Solution and start create new assets or add changes into a new Solution so you can move/back up your customizations and configurations later on. 

Part 1: Prepare the core tables to store Order Data
1. Create 2 new Dataverse tables. Think about the data type for each column.
    * Order (Order Number, Order Data, Order Total, Customer Full Name, Customer Address, Customer Email and Customer Phone Number)
    * Oder should have an Autogenerated Order Confirmation Code to indicate that Order info has been saved into Order table (Order Code)
    * Order Line Item (Product Code, Product Description, Quantity, Unit Price)
2. Maintain the 1:N relationship between Order and Order Line Item
	
Part 2: Build the Cloud flow
1. Trigger of the Cloud flow - consider which trigger type can handle incoming emails
2. As Order Information is coming as Attachment in the email, it is important to check which file type that is received
3. Once the flow is set up to handle information, we need to integrate the model in challenge 2 into the cloud flow.
    * Consider which action to use for AI Builder Model
    * Save the information of Order and Customer extracted from PDF into Order Table
    * Save the information of Order Detail extracted from PDF to Order Line Item Table
    * Maintain the relationship between Order and Order Line Item
4. Send response email to sender to confirm that Order is received with extract information and Auto generated confirmation Order Code.

## Note

* [Link to Order PDF Sample in What The Hack Student Resources](https://github.com/tadthompson/WhatTheHack/blob/xxx-PowerPlatformBasic/xxx-PowerPlatformBasic/Student/Resources/TailspinToysBaseApp_20221202.zip)

## Success Criteria

To complete this challenge successfully, you should be able to:
- Managing the volume of incoming orders without relying on people to monitor mailbox
- Demonstrate that the Model that we built in Challenge can be integrated with Power Automate flow
- Successfully save order information into Dataverse
- Respond to the customer order with processing information and Order Code

## Learning Resources

* [Use the document processing model in Power Automate - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/form-processing-model-in-flow)
* [Use the form processor component in Power Apps - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/form-processor-component-in-powerapps)
* [What is Microsoft Dataverse? - Power Apps | Microsoft Learn](https://learn.microsoft.com/en-us/power-apps/maker/data-platform/data-platform-intro)
* [Solution concepts - Power Platform | Microsoft Learn](https://learn.microsoft.com/en-us/power-platform/alm/solution-concepts-alm)


## Advanced Challenges

Too comfortable? Eager to do more? Try these additional challenges!
- Handle Exception Cases (What if the model extracting data incorrectly).
- Try to use the AI Model that extracts Order Information in Power Apps Canvas App
* [Explore the Document automation toolkit - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/doc-automation?msclkid=d7043197d0a211ec83ca9d25453fab57)


