# Challenge 03 - Extract Order Data to Dataverse Using Power Automate

[< Previous Challenge](./Challenge-02.md) - **[Home](../README.md)** - [Next Challenge >](./Challenge-04.md)

## Introduction

Current process: All orders from larger contracts come through a single shared mailbox. Order would be sent as an attachment using the Ordering Product Template.

In this challenge you will discuss the value of automation, synergizing automation with people, and implementing power automate and AI Builder.

Power Automate is a service that helps you create automated workflows between your favorite apps and services to synchronize files, get notifications, collect data, and more. Now that you have provisioned the proper licenses to unlock access to Power Apps and Power Automate and, AI builder is trained and tested from challenge 2, you are ready to start using Power Automate to integrate with your AI builder to do form processing and store the data into Dataverse tables. 

## Description

In this challenge, you will build a cloud flow to extract data from the forms and save them into Dataverse.  
The good practice is to create a new Solution and start create new assets or add changes into a new Solution so you can move/back up your customizations and configurations later on. 

### Prepare the core tables to store Order Data

- Create 2 new Dataverse tables. Think about the data type for each column.
  - Order (Order Number, Order Data, Order Total, Customer (Lookup))
  - Order should have an Autogenerated Order Code to indicate that Order info has been saved into Order table (Order Code)
  - Order Line Item (Product Code, Product Description, Quantity, Unit Price)
- Maintain the 1:N relationship between Order and Order Line Item
	
### Build the Cloud flow
- Trigger of the Cloud flow - consider which trigger type can handle incoming emails
- As Order Information is coming as Attachment in the email, it is important to check for an attachment.
- Once the flow is set up to handle information, we need to integrate the model in challenge 2 into the cloud flow.
  - Consider which action to use for AI Builder Model
  - Save the information of Order and related Customer extracted from PDF into Dataverse
  - Save the information of Order Detail extracted from PDF to Order Line Item Table
  - Maintain the relationship between Order and Order Line Item
- Send response email to sender to confirm that Order is received with extract information and Auto generated confirmation Order Code.

## Success Criteria

To complete this challenge successfully, you should be able to:
- Manage the volume of incoming orders without relying on people to monitor mailbox
- Demonstrate that the Model that we used in the challenge can be integrated with a Power Automate flow
- Successfully save order information into Dataverse
- Respond to the customer order with processing information and Order Confirmation Code

## Learning Resources

* [Use the document processing model in Power Automate - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/form-processing-model-in-flow)
* [Use the form processor component in Power Apps - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/form-processor-component-in-powerapps)
* [What is Microsoft Dataverse? - Power Apps | Microsoft Learn](https://learn.microsoft.com/en-us/power-apps/maker/data-platform/data-platform-intro)
* [Solution concepts - Power Platform | Microsoft Learn](https://learn.microsoft.com/en-us/power-platform/alm/solution-concepts-alm)
* [Use Lists of rows in Power Automate flows](https://learn.microsoft.com/en-us/power-automate/dataverse/list-rows)

## Advanced Challenges

Too comfortable? Eager to do more? Try these additional challenges!
- Handle Exception Cases. What if the model extracts data incorrectly?
- Try to use the AI Model that extracts Order Information in Power Apps Canvas App (next challenge)
* [Explore the Document automation toolkit - AI Builder | Microsoft Docs](https://docs.microsoft.com/en-us/ai-builder/doc-automation?msclkid=d7043197d0a211ec83ca9d25453fab57)
